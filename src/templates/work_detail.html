{% extends "base.html" %}

{% block title %}{{ work.title }} - {{ super() }}{% endblock %}

{% block content %}
<div class="detail-layout">
    <div class="detail-sidebar">
        <div class="detail-cover-container">
            {% if work.cover_url %}
            <img src="{{ work.cover_url }}" class="detail-cover" alt="{{ work.title }}">
            {% else %}
            <svg class="detail-cover-placeholder" viewBox="0 0 100 150" fill="none">
                <rect width="100" height="150" fill="var(--bg-hover)"/>
                <rect x="10" y="20" width="80" height="2" fill="var(--border-color)"/>
                <rect x="10" y="35" width="60" height="2" fill="var(--border-color)"/>
                <rect x="10" y="50" width="70" height="2" fill="var(--border-color)"/>
                <path d="M30 80 L50 100 L70 80" stroke="var(--border-color)" stroke-width="2" fill="none"/>
            </svg>
            {% endif %}
        </div>
        <div class="detail-divider"></div>
        <h1 class="detail-title">{{ work.title }}</h1>
        <div class="detail-actions">
            <a href="{{ url_for('books.work_edit', id=work.id) }}" class="button button-primary">Edit</a>
            <button class="button button-danger" onclick="openDeleteModal()">Delete</button>
        </div>
    </div>

    <div class="detail-content">
        <div class="detail-info-card">
            <h3 class="info-section-title">Work Information</h3>
            
            {% if work.isbn %}
            <div class="info-item">
                <strong class="info-label">ISBN:</strong>
                <span class="info-value">{{ work.isbn }}</span>
            </div>
            {% endif %}
            
            {% if work.authors %}
            <div class="info-item">
                <strong class="info-label">Authors:</strong>
                <div class="info-badges">
                    {% for author in work.authors %}
                    <a href="{{ url_for('authors.author_detail', id=author.id) }}" class="info-badge info-badge-primary">{{ author.primary_name }}</a>
                    {% endfor %}
                </div>
            </div>
            {% endif %}
            
            {% if work.tags %}
            <div class="info-item">
                <strong class="info-label">Tags:</strong>
                <div class="info-badges">
                    {% for tag in work.tags %}
                    <a href="{{ url_for('tags.tag_detail', id=tag.id) }}" class="info-badge info-badge-secondary">{{ tag.label }}</a>
                    {% endfor %}
                </div>
            </div>
            {% endif %}
            
            {% if work.description %}
            <div class="info-item">
                <strong class="info-label">Description:</strong>
                <p class="info-description">{{ work.description }}</p>
            </div>
            {% endif %}
        </div>
    </div>
</div>

<div class="form-actions">
    <a href="{{ url_for('books.work_list') }}" class="button button-secondary">Back to Works</a>
</div>

<!-- Delete Modal -->
<div id="deleteModal" class="modal">
    <div class="modal-overlay" onclick="closeDeleteModal()"></div>
    <div class="modal-container">
        <div class="modal-header">
            <h3 class="modal-title">Confirm Delete</h3>
            <button class="modal-close" onclick="closeDeleteModal()">&times;</button>
        </div>
        <div class="modal-body">
            Are you sure you want to delete "{{ work.title }}"?
        </div>
        <div class="modal-footer">
            <button class="button button-secondary" onclick="closeDeleteModal()">Cancel</button>
            <form action="{{ url_for('books.work_delete', id=work.id) }}" method="post" style="display: inline;">
                <button type="submit" class="button button-danger">Delete</button>
            </form>
        </div>
    </div>
</div>

<script>
function openDeleteModal() {
    document.getElementById('deleteModal').classList.add('active');
}

function closeDeleteModal() {
    document.getElementById('deleteModal').classList.remove('active');
}
</script>
{% endblock %}